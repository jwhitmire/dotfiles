#!/bin/bash

triage_count=$( ping -c 1 triage.vm | grep icmp* | wc -l )
if [ $triage_count -eq 0 ]
then
   echo "triage.vm is down"
else
    if [ "$(ls -A ~/work/vm/triage)" ]
    then
        echo "triage.vm already mounted"
    else
        sshfs triage.vm:/srv/appliance/current ~/work/vm/triage -o volname=triage.vm
        echo "triage.vm mounted"
    fi

    if [ "$(ls -A ~/work/vm/mothership)" ]
    then
        echo "mothership.vm already mounted"
    else
        sshfs triage.vm:/srv/mothership/current ~/work/vm/mothership -o volname=mothership.vm
        echo "mothership.vm mounted"
    fi

    if [ "$(ls -A ~/work/vm/home)" ]
    then
        echo "home.vm already mounted"
    else
        sshfs triage.vm:/home/deploy ~/work/vm/home -o volname=home.vm
        echo "home.vm mounted"
    fi
fi

